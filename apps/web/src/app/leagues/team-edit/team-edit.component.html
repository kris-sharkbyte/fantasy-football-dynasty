<div class="container mx-auto px-4 py-6 max-w-4xl">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
      Edit Team Settings
    </h1>
    <p class="text-gray-600 dark:text-gray-400">
      Customize your team name, location, and stadium to influence player
      preferences and contract negotiations.
    </p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="flex justify-center items-center py-12">
    <p-progressSpinner
      styleClass="w-12 h-12"
      strokeWidth="4"
      fill="var(--surface-ground)"
      animationDuration=".5s"
    >
    </p-progressSpinner>
  </div>

  <!-- Team Edit Form -->
  <form
    *ngIf="!isLoading()"
    [formGroup]="teamForm"
    (ngSubmit)="onSubmit()"
    class="space-y-6"
  >
    <!-- Team Name Section -->
    <p-card header="Team Identity" styleClass="shadow-lg">
      <div class="space-y-4">
        <div>
          <label
            for="teamName"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
          >
            Team Name *
          </label>
          <p-inputText
            id="teamName"
            formControlName="name"
            placeholder="Enter your team name"
            class="w-full"
            [class.ng-invalid]="
              teamForm.get('name')?.invalid && teamForm.get('name')?.touched
            "
            [class.ng-dirty]="teamForm.get('name')?.dirty"
          >
          </p-inputText>
          <small
            *ngIf="
              teamForm.get('name')?.invalid && teamForm.get('name')?.touched
            "
            class="p-error block mt-1"
          >
            Team name is required and must be at least 3 characters long.
          </small>
        </div>
      </div>
    </p-card>

    <!-- Location & Stadium Section -->
    <p-card header="Location & Stadium" styleClass="shadow-lg">
      <div class="space-y-6">
        <!-- City Selection -->
        <div>
          <label
            for="city"
            class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
          >
            City & Market *
          </label>
          <p-select
            id="city"
            formControlName="city"
            [options]="cityOptions"
            optionLabel="city"
            placeholder="Select a city"
            class="w-full"
            (onChange)="onCityChange()"
            [class.ng-invalid]="
              teamForm.get('city')?.invalid && teamForm.get('city')?.touched
            "
          >
            <ng-template pTemplate="selectedItem" let-city>
              <div class="flex items-center">
                <span class="font-medium"
                  >{{ city.city }}, {{ city.state }}</span
                >
                <span class="ml-2 text-sm text-gray-500"
                  >({{ city.marketSize }} market)</span
                >
              </div>
            </ng-template>
            <ng-template pTemplate="item" let-city>
              <div class="flex items-center justify-between w-full">
                <div>
                  <span class="font-medium"
                    >{{ city.city }}, {{ city.state }}</span
                  >
                  <span class="ml-2 text-sm text-gray-500">{{
                    city.timezone
                  }}</span>
                </div>
                <div class="text-right text-sm">
                  <div class="font-medium capitalize">
                    {{ city.marketSize }} market
                  </div>
                  <div class="text-gray-500 capitalize">{{ city.climate }}</div>
                </div>
              </div>
            </ng-template>
          </p-select>
          <small
            *ngIf="
              teamForm.get('city')?.invalid && teamForm.get('city')?.touched
            "
            class="p-error block mt-1"
          >
            Please select a city for your team.
          </small>
        </div>

        <!-- City Details Display -->
        <div
          *ngIf="selectedCity"
          class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4"
        >
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
            <div>
              <span class="font-medium text-gray-700 dark:text-gray-300"
                >Market Size:</span
              >
              <div class="text-gray-900 dark:text-white">
                {{ marketSizeLabel }}
              </div>
            </div>
            <div>
              <span class="font-medium text-gray-700 dark:text-gray-300"
                >Climate:</span
              >
              <div class="text-gray-900 dark:text-white">
                {{ climateLabel }}
              </div>
            </div>
            <div>
              <span class="font-medium text-gray-700 dark:text-gray-300"
                >Tax Rate:</span
              >
              <div class="text-gray-900 dark:text-white">
                {{ taxRateLabel }}
              </div>
            </div>
            <div>
              <span class="font-medium text-gray-700 dark:text-gray-300"
                >Timezone:</span
              >
              <div class="text-gray-900 dark:text-white">
                {{ selectedCity.timezone }}
              </div>
            </div>
          </div>
        </div>

        <!-- Stadium Customization -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              for="stadiumName"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >
              Stadium Name *
            </label>
            <p-inputText
              id="stadiumName"
              formControlName="customStadiumName"
              placeholder="Enter stadium name"
              class="w-full"
              [class.ng-invalid]="
                teamForm.get('customStadiumName')?.invalid &&
                teamForm.get('customStadiumName')?.touched
              "
            >
            </p-inputText>
            <small
              *ngIf="
                teamForm.get('customStadiumName')?.invalid &&
                teamForm.get('customStadiumName')?.touched
              "
              class="p-error block mt-1"
            >
              Stadium name is required.
            </small>
          </div>

          <div>
            <label
              for="stadiumCapacity"
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"
            >
              Stadium Capacity *
            </label>
            <p-inputNumber
              id="stadiumCapacity"
              formControlName="customStadiumCapacity"
              placeholder="Enter capacity"
              class="w-full"
              [min]="10000"
              [max]="100000"
              [class.ng-invalid]="
                teamForm.get('customStadiumCapacity')?.invalid &&
                teamForm.get('customStadiumCapacity')?.touched
              "
            >
            </p-inputNumber>
            <small
              *ngIf="
                teamForm.get('customStadiumCapacity')?.invalid &&
                teamForm.get('customStadiumCapacity')?.touched
              "
              class="p-error block mt-1"
            >
              Capacity must be between 10,000 and 100,000.
            </small>
          </div>
        </div>
      </div>
    </p-card>

    <!-- Team Status Section -->
    <p-card header="Team Status" styleClass="shadow-lg">
      <div class="space-y-4">
        <div class="flex items-center space-x-4">
          <div class="flex items-center">
            <input
              id="isContender"
              type="checkbox"
              formControlName="isContender"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label
              for="isContender"
              class="ml-2 text-sm font-medium text-gray-700 dark:text-gray-300"
            >
              Contending Team
            </label>
          </div>
          <div class="flex items-center">
            <input
              id="isStable"
              type="checkbox"
              formControlName="isStable"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label
              for="isStable"
              class="ml-2 text-sm font-medium text-gray-700 dark:text-gray-300"
            >
              Stable Management
            </label>
          </div>
        </div>

        <div
          class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"
        >
          <div class="flex">
            <div class="flex-shrink-0">
              <svg
                class="h-5 w-5 text-blue-400"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  fill-rule="evenodd"
                  d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                  clip-rule="evenodd"
                />
              </svg>
            </div>
            <div class="ml-3">
              <h3 class="text-sm font-medium text-blue-800 dark:text-blue-200">
                How This Affects Player Decisions
              </h3>
              <div class="mt-2 text-sm text-blue-700 dark:text-blue-300">
                <p>
                  Players consider location, climate, market size, and team
                  status when evaluating contract offers. Cold weather players
                  prefer northern teams, big market players want large cities,
                  and winning players prioritize contender status.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </p-card>

    <!-- Action Buttons -->
    <div class="flex justify-end space-x-4 pt-6">
      <p-button
        type="button"
        label="Cancel"
        severity="secondary"
        (onClick)="onCancel()"
        [disabled]="isSubmitting()"
        styleClass="px-6"
      >
      </p-button>

      <p-button
        type="submit"
        label="Save Changes"
        [loading]="isSubmitting()"
        [disabled]="teamForm.invalid || isSubmitting()"
        styleClass="px-6"
      >
      </p-button>
    </div>
  </form>
</div>

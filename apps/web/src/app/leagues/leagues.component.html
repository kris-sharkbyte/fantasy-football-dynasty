<div class="space-y-8">
  <div class="flex justify-between items-center">
    <h1 class="text-3xl font-bold text-secondary-900">My Leagues</h1>
    <div class="flex gap-2">
      <p-button
        label="Refresh"
        icon="pi pi-refresh"
        severity="secondary"
        [loading]="isLoading()"
        (click)="refreshLeagues()"
      ></p-button>
      <p-button
        label="Create League"
        icon="pi pi-plus"
        routerLink="/leagues/create"
        severity="primary"
        size="large"
      ></p-button>
    </div>
  </div>

  @if (error()) {
  <p-message
    severity="error"
    [text]="error()!"
    [closable]="true"
    (onClose)="clearError()"
  ></p-message>
  } @if (isLoading()) {
  <div class="flex justify-center py-12">
    <p-progressSpinner></p-progressSpinner>
  </div>
  } @if (!isLoading()) {
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    @for (league of leagues(); track league.id) {
    <p-card
      [header]="league.name"
      styleClass="league-card cursor-pointer hover:shadow-lg transition-shadow duration-300"
      (click)="navigateToLeague(league.id)"
    >
      <div class="space-y-3">
        <div class="flex items-center justify-between">
          <p-chip
            [label]="league.rules.draft.rounds + ' roster spots'"
            icon="pi pi-users"
          ></p-chip>
          <p-badge
            [value]="league.phase"
            [severity]="getStatusSeverity(league.phase)"
          ></p-badge>
        </div>

        <div class="space-y-2 text-secondary-600">
          <div class="flex items-center gap-2">
            <i class="pi pi-calendar text-primary-500"></i>
            <span>Phase: {{ league.phase | titlecase }}</span>
          </div>
          <div class="flex items-center gap-2">
            <i class="pi pi-calendar-plus text-primary-500"></i>
            <span>Year: {{ league.currentYear }}</span>
          </div>
          <div class="flex items-center gap-2">
            <i class="pi pi-dollar text-primary-500"></i>
            <span
              >Salary Cap: ${{
                league.rules.cap.salaryCap | number : '1.0-0'
              }}M</span
            >
          </div>
          <div class="flex items-center gap-2">
            <i class="pi pi-star text-primary-500"></i>
            <span>{{
              league.rules.scoring.ppr === 1
                ? 'PPR'
                : league.rules.scoring.ppr === 0.5
                ? 'Half PPR'
                : 'Standard'
            }}</span>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <p-chip [label]="league.phase | titlecase" icon="pi pi-flag"></p-chip>
        </div>
      </div>

      <ng-template pTemplate="footer">
        <div class="flex gap-2">
          <p-button
            label="View League"
            icon="pi pi-external-link"
            [routerLink]="['/leagues', league.id]"
            severity="secondary"
            size="small"
            (click)="$event.stopPropagation()"
          ></p-button>
          <p-button
            label="Manage"
            icon="pi pi-cog"
            severity="secondary"
            outlined="true"
            size="small"
            (click)="$event.stopPropagation()"
          ></p-button>
        </div>
      </ng-template>
    </p-card>
    }
  </div>
  } @if (!isLoading() && leagues().length === 0) {
  <div class="text-center py-12">
    <div class="mb-6">
      <i class="pi pi-trophy text-6xl text-secondary-400"></i>
    </div>
    <h3 class="text-xl font-semibold text-secondary-700 mb-2">
      No Leagues Yet
    </h3>
    <p class="text-lg text-secondary-600 mb-6">
      You haven't joined any leagues yet. Create your first dynasty league to
      get started!
    </p>
    <p-button
      label="Create Your First League"
      icon="pi pi-plus"
      routerLink="/leagues/create"
      severity="primary"
      size="large"
    ></p-button>
  </div>
  }
</div>
